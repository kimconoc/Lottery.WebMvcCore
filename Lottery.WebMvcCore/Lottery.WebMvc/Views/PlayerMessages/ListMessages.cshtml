@using Lottery.DoMain.Constant;
@using Newtonsoft.Json;
@using Lottery.DoMain.Enum;
@using Lottery.DoMain.Models;
@using Lottery.DoMain.Extentions;
@model Tuple<MessgeByDaySession, List<DetailMessage>>;
@{
    Layout = null;
    var serializedModel1 = Newtonsoft.Json.JsonConvert.SerializeObject(Model.Item1);
}

<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="~/css/listMessages.css" rel="stylesheet" />
    <script src="~/Scripts/jquery/jquery-3.3.1.js"></script>
    <script src="~/js/constant.js"></script>
    <script src="~/lib/jquery/dist/jquery.js"></script>
    <link href="~/css/site.css" rel="stylesheet" />
    @*master-plan*@
    <script src="~/assets/helpers/master-plan/adr_common.js"></script>
    <script src="~/assets/helpers/master-plan/iosOverlay.js"></script>
    <link href="~/assets//helpers/master-plan/style.css" rel="stylesheet" />
    @*cssscript*@
    <script src="~/assets/helpers/awesome-alert-main/awesomealert.js"></script>
    <link rel="stylesheet" href="~/assets/helpers/awesome-alert-main/style.css" />
    @*Syncfusion*@
    <link href="https://cdn.syncfusion.com/ej2/22.2.5/ej2-base/styles/material.css" rel="stylesheet">
    <link href="https://cdn.syncfusion.com/ej2/22.2.5/ej2-inputs/styles/material.css" rel="stylesheet">
    <link href="https://cdn.syncfusion.com/ej2/22.2.5/ej2-dropdowns/styles/material.css" rel="stylesheet">
    <link href="https://cdn.syncfusion.com/ej2/22.2.5/ej2-buttons/styles/material.css" rel="stylesheet">
    <script src="https://cdn.syncfusion.com/ej2/22.2.5/dist/ej2.min.js" type="text/javascript"></script>
    <script src="https://cdn.syncfusion.com/ej2/syncfusion-helper.js" type="text/javascript"></script>
    @*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">*@
    @*datetimepicker*@
    <link rel="stylesheet" type="text/css" href="~/assets/helpers/datetimepicker-master/jquery.datetimepicker.css" />
    <script src="~/assets/helpers/datetimepicker-master/jquery.datetimepicker.full.min.js"></script>
    <style>

        .title-page {
            padding: 3px 10px 3px 5px;
            display: flex;
            justify-content: space-between;
        }

        .title-page-text {
            margin-top: 12px;
            cursor: pointer;
        }

        .container-listMessages{
            padding: 55px 10px 0px 10px ;
        }

        .somebutton{
            display: flex;
            flex-flow:column; 
            gap:1.5px;
            align-items: center;
        }

            .somebutton i {
                font-size: 25px;
 
            }

            .somebutton span {
                font-size: 16px;
            }
        .div-content-message{
            margin-bottom:10px;
        }

        .mainContent-message {
            display: inline-block;
            border-radius: 10px 0 10px 0;
            background-color: #dee8fc;
            padding: 8px;
            top: 5px;
            font-family: sans-serif;
            font-weight: 500;
        }

        .div-handle-message {
            color: #e3165b;
        }

    </style>
</head>
<body>
    <header class="header-page">
        <div class="title-page">
            <div onclick="goToAddBackPage()" class="title-page-text">
                <i class="fa fa-chevron-left" aria-hidden="true"></i>
                @{
                    string titlePageGoBack = string.Empty;
                    switch (Model.Item1.Region)
                    {
                        case (int)RegionEnum.MienNam:
                            titlePageGoBack = RegionEnum.MienNam.GetDescription();
                            break;
                        case (int)RegionEnum.MienTrung:
                            titlePageGoBack = RegionEnum.MienTrung.GetDescription();
                            break;
                        default:
                            titlePageGoBack = RegionEnum.MienBac.GetDescription();
                            break;
                    }
                    titlePageGoBack = string.Format(@Model.Item1.NamePlayer + " - " + titlePageGoBack);
                    @titlePageGoBack;
                }
            </div>

            <button class="somebutton title-page-btn">
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <span>@Model.Item1.HandlDate?.ToString("dd/MM/yyyy")</span>
            </button>
        </div>
    </header>
    <div class="container-listMessages">
        <div class="div-list-messages">
            @{
                int count = 0;
                foreach (var item in Model.Item2)
                {
                    count = count + 1;
                    <div class="div-content-message">
                        <div class="mainContent-message">
                            @item.Message
                        </div>
                    </div>
                    <div class="div-handle-message">
                        @string.Format("Đã xử lý: {0}",item.HandlDate.ToString("dd/MM/yyyy HH:mm:ss"))
                    </div>
                    if (count < Model.Item2.Count)
                    {
                        <div style="margin-bottom:10px;" class="border-bottom-row"></div>
                    }
                }
            }
        </div>
        <input id="datetimepicker" style="display:none;" type="text">
    </div>

    <script>
        var model1 = @Html.Raw(serializedModel1);
        jQuery.datetimepicker.setLocale('vi');
        jQuery('#datetimepicker').datetimepicker({
            timepicker: false,
            value: '@Model.Item1.HandlDate?.ToString("yyyy/MM/dd HH:mm")'
        });
        function goToAddBackPage() {
            window.location.href = `/PlayerMessages/MessagesByDay?idPlayer=${model1.IdPlayer}&namePlayer=${model1.NamePlayer}&region=${model1.Region}&cachTrungDaThang=${model1.CachTrungDaThang}&cachTrungDaXien=${model1.CachTrungDaXien}&strDateTime=@Model.Item1.HandlDate?.ToString("yyyy/MM/dd HH:mm")`;
        }
        $('button.somebutton').on('click', function () {
            $('#datetimepicker').datetimepicker('show');
        });
    </script>
</body>
</html>